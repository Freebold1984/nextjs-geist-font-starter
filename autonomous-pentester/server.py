from fastapi import FastAPI
from fastapi.responses import JSONResponse
from scanner.scanner import run_scan
import asyncio

app = FastAPI()

@app.get("/scan/{target}")
async def scan_target(target: str):
    loop = asyncio.get_event_loop()
    results = await loop.run_in_executor(None, run_scan, target)
    return JSONResponse(content=results)

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=8000)
