import json
import os

def load_vulnerability_dataset(dataset_path):
    """
    Load and preprocess vulnerability dataset from a single JSON file.
    The dataset should contain samples with vulnerability descriptions and labels.
    """
    data = []
    labels = []
    if os.path.isfile(dataset_path):
        with open(dataset_path, "r") as f:
            samples = json.load(f)
            for sample in samples:
                description = sample.get("description", "")
                label = sample.get("label", "")
                data.append(description)
                labels.append(label)
    else:
        raise FileNotFoundError(f"Dataset file not found: {dataset_path}")
    return data, labels
